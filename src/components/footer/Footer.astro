---
import { getLangFromUrl, useTranslations, getLocalizedPath } from '@/i18n/utils';
import type { LanguageKey } from '@/i18n/types';
import FooterBrand from '@/components/footer/FooterBrand.astro';
import FooterLinks, { type Link } from '@/components/footer/FooterLinks.astro';
import FooterBottomBar from '@/components/footer/FooterBottomBar.astro';

const lang = getLangFromUrl(Astro.url) as LanguageKey;
const t = useTranslations(lang);
const currentYear = new Date().getFullYear();
const navigationLinks: Link[] = [
  { href: getLocalizedPath('/', lang), text: t('nav.home'), isLocalized: false },
  { href: getLocalizedPath('/blog', lang), text: t('nav.blog'), isLocalized: false },
  { href: getLocalizedPath('/services', lang), text: t('nav.services'), isLocalized: false },
  { href: getLocalizedPath('/about', lang), text: t('nav.about'), isLocalized: false },
  { href: '/search', text: t('nav.search'), isLocalized: false },
];
const legalLinks: Link[] = [
  { href: getLocalizedPath('/contact', lang), text: t('footer.links.contact'), isLocalized: false },
  {
    href: getLocalizedPath('/cookies', lang),
    text: t('footer.links.cookies'),
    isLocalized: false,
  },
  {
    href: getLocalizedPath('/privacy', lang),
    text: t('footer.links.privacy'),
    isLocalized: false,
  },
  {
    href: getLocalizedPath('/terms', lang),
    text: t('footer.links.terms'),
    isLocalized: false,
  },
];
const resourceLinks: Link[] = [
  { href: 'https://astro.build', text: 'Astro.js', isExternal: true },
  { href: 'https://tailwindcss.com', text: 'Tailwind CSS', isExternal: true },
  { href: 'https://decapcms.org', text: 'Decap CMS', isExternal: true },
];
---

<footer
  class="border-t border-gray-200 bg-gray-50 transition-colors duration-300 dark:border-gray-700 dark:bg-slate-900/80"
  role="contentinfo"
  aria-labelledby="footer-heading"
>
  <h2 id="footer-heading" class="sr-only">Footer</h2>
  <div class="mx-auto max-w-7xl px-4 py-2 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 justify-around md:grid-cols-5">
      <FooterBrand lang={lang} />
      <FooterLinks
        title="Navigation"
        links={navigationLinks}
        lang={lang}
        aria-label="Main navigation in footer"
      />
      <FooterLinks
        title="Resources"
        links={resourceLinks}
        lang={lang}
        aria-label="External resources"
      />
      <FooterLinks title="Legal" links={legalLinks} lang={lang} aria-label="Legal information" />
    </div>
    <FooterBottomBar lang={lang} currentYear={currentYear} />
  </div>
</footer>
