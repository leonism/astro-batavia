---
---

<button id="open-search-overlay" class="text-gray-600 mr-2 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="Open search" aria-controls="search-overlay" aria-haspopup="dialog">
  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
  </svg>
</button>

<script>
  // Make toggleSearchOverlay globally accessible
  function toggleSearchOverlay(show) {
    const searchOverlay = document.getElementById("search-overlay");
    if (!searchOverlay) return;
    if (show) {
      searchOverlay.classList.remove("hidden");
      searchOverlay.setAttribute("aria-hidden", "false");
      const searchInput = searchOverlay.querySelector("#search-input");
      if (searchInput) {
        (searchInput as HTMLElement).focus();
      }
    } else {
      searchOverlay.classList.add("hidden");
      searchOverlay.setAttribute("aria-hidden", "true");
      const searchInput = searchOverlay.querySelector("#search-input");
      if (searchInput) {
        (searchInput as HTMLInputElement).value = ""; // Clear search input on close
      }
      const searchResultsContainer = searchOverlay.querySelector("#search-results-container");
      if (searchResultsContainer) {
        searchResultsContainer.innerHTML = ""; // Clear results on close
      }
    }
  }

  document.addEventListener("astro:page-load", () => {
    const openSearchOverlayButton = document.getElementById("open-search-overlay");
    const closeSearchOverlayButtonFromOverlay = document.getElementById("close-search-overlay");

    if (openSearchOverlayButton) {
      openSearchOverlayButton.addEventListener("click", () => toggleSearchOverlay(true));
    }

    if (closeSearchOverlayButtonFromOverlay) {
      closeSearchOverlayButtonFromOverlay.addEventListener("click", () => toggleSearchOverlay(false));
    }

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape" && !document.getElementById("search-overlay").classList.contains("hidden")) {
        toggleSearchOverlay(false);
      }
    });
  });
</script>
