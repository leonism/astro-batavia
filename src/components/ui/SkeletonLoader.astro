---

---

<div
  id="page-transition-skeleton"
  transition:persist
  class="pointer-events-none fixed inset-0 z-[9999] hidden bg-white opacity-0 transition-opacity duration-300 dark:bg-slate-900"
  aria-hidden="true"
>
  <div class="mx-auto max-w-7xl animate-pulse px-4 py-12 pt-24 sm:px-6 lg:px-8">
    <!-- Header Skeleton -->
    <div class="mb-8 h-8 w-48 rounded bg-gray-200 dark:bg-gray-800"></div>

    <!-- Hero Section Skeleton -->
    <div class="mb-12 h-64 w-full rounded-xl bg-gray-200 dark:bg-gray-800 md:h-96"></div>

    <!-- Content Grid Skeleton -->
    <div class="grid grid-cols-1 gap-8 md:grid-cols-3">
      <!-- Sidebar/Left Col -->
      <div class="col-span-1 hidden space-y-4 md:block">
        <div class="h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
        <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-800"></div>
        <div class="h-4 w-5/6 rounded bg-gray-200 dark:bg-gray-800"></div>
        <div class="mt-8 h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
        <div class="h-4 w-2/3 rounded bg-gray-200 dark:bg-gray-800"></div>
      </div>

      <!-- Main Content -->
      <div class="col-span-1 space-y-6 md:col-span-2">
        <div class="mb-4 h-8 w-3/4 rounded bg-gray-200 dark:bg-gray-800"></div>
        <div class="space-y-3">
          <div class="h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
          <div class="h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
          <div class="h-4 w-5/6 rounded bg-gray-200 dark:bg-gray-800"></div>
        </div>
        <div class="mt-6 h-48 w-full rounded-lg bg-gray-200 dark:bg-gray-800"></div>
        <div class="mt-6 space-y-3">
          <div class="h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
          <div class="h-4 w-11/12 rounded bg-gray-200 dark:bg-gray-800"></div>
          <div class="h-4 w-full rounded bg-gray-200 dark:bg-gray-800"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Use a self-executing function to avoid global scope pollution
  (() => {
    let skeletonTimeout: ReturnType<typeof setTimeout>;

    function showSkeleton() {
      const skeleton = document.getElementById('page-transition-skeleton');
      if (skeleton) {
        clearTimeout(skeletonTimeout);
        skeleton.classList.remove('hidden');
        // Force reflow
        void skeleton.offsetWidth;
        skeleton.classList.remove('opacity-0');
      }
    }

    function hideSkeleton() {
      const skeleton = document.getElementById('page-transition-skeleton');
      if (skeleton) {
        skeleton.classList.add('opacity-0');
        skeletonTimeout = setTimeout(() => {
          skeleton.classList.add('hidden');
        }, 300);
      }
    }

    // Astro View Transition Events
    document.addEventListener('astro:before-preparation', showSkeleton);
    document.addEventListener('astro:after-swap', () => {
      // Ensure skeleton is visible immediately after swap if it was showing
      const skeleton = document.getElementById('page-transition-skeleton');
      if (skeleton) {
        skeleton.classList.remove('hidden');
        skeleton.classList.remove('opacity-0');
      }
    });
    document.addEventListener('astro:page-load', hideSkeleton);
  })();
</script>
